#!/bin/sh 
if [ "$1" = "" ]; then
    echo "You need to specify the input files. Use pwstats --help for more information"
elif [ "$1" = "--help" ]
then
    echo "Password static generator"
    echo ""
    echo "Usage:"
    echo "  pwstats --help: print this message"
    echo "  pwstats <path/to/your/logs/folder/logs-you-want-to-have-analyzed>"
    echo ""
    echo "Hint:"
    echo "  Get todays stats with  <path/to/your/logs/folder/cowrie.log>"
    echo "  Get total stats with <path/to/your/logs/folder/cowrie.log.*>"
    echo ""
    echo "Written by CryptKiddie and NetSysFire"
else
    cat $1 |grep "login attempt" |grep -Po "\[SSHService 'ssh-userauth' on HoneyPotSSHTransport,[0-9]+,[0-9.]+\] login attempt \[[a-zA-z0-9.-]+\/[a-zA-Z0-9.-]+\]" $1 | awk '{print $NF}' | sort | uniq -c |sort -h
fi
